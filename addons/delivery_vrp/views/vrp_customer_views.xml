<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Vue liste principale VRP simplifiée -->
    <record id="vrp_order_tree_view_enhanced" model="ir.ui.view">
        <field name="name">vrp.order.tree.enhanced</field>
        <field name="model">vrp.order</field>
        <field name="arch" type="xml">
            <list string="Commandes VRP" default_group_by="assigned_vehicle_id" expand="1">
                <header>
                    <button name="action_optimize_delivery_enhanced" type="object" 
                            string="Optimize Enhanced" class="btn-primary"/>
                    <button name="action_show_map" type="object" 
                            string="Map" class="btn-secondary"/>
                </header>
                
                <field name="delivery_sequence" string="Seq"/>
                <field name="name" string="Delivery Order"/>
                <field name="partner_id" string="Customer"/>
                <field name="delivery_address" string="Delivery Address"/>
                
                <!-- NOUVELLES COLONNES SIMPLES -->
                <field name="product_count" string="Products"/>
                <field name="picked_products" string="Picked" widget="boolean_toggle"/>
                <field name="assigned_vehicle_id" string="Vehicle"/>
                <field name="manual_assignment" string="Manual" widget="boolean_toggle"/>
                <field name="driver_id" string="Driver"/>
            </list>
        </field>
    </record>

    <!-- Vue formulaire simplifiée -->
    <record id="vrp_order_form_view_enhanced" model="ir.ui.view">
        <field name="name">vrp.order.form.enhanced</field>
        <field name="model">vrp.order</field>
        <field name="arch" type="xml">
            <form string="Commande VRP">
                <header>
                    <button name="action_toggle_picked_status" type="object" 
                            string="Toggle Picked" class="btn-primary"/>
                </header>
                
                <sheet>
                    <group>
                        <group>
                            <field name="sale_order_id"/>
                            <field name="name"/>
                            <field name="partner_id"/>
                            <field name="delivery_address"/>
                        </group>
                        <group>
                            <field name="assigned_vehicle_id"/>
                            <field name="delivery_sequence"/>
                            <field name="manual_assignment"/>
                            <field name="driver_id"/>
                            <field name="picked_products"/>
                            <field name="picked_date" invisible="not picked_products"/>
                            <field name="picked_by" invisible="not picked_products"/>
                        </group>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <!-- Action principale -->
    <record id="vrp_customer_action" model="ir.actions.act_window">
        <field name="name">VRP - Gestion Clients</field>
        <field name="res_model">vrp.order</field>
        <field name="view_mode">list,form</field>
        <field name="view_id" ref="vrp_order_tree_view_enhanced"/>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Interface VRP - Gestion des Livraisons
            </p>
            <p>
                Optimisez vos livraisons et gérez le picking des produits.
            </p>
        </field>
    </record>
</odoo>